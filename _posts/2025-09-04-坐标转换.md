---
title: 坐标转换
date: 2025-09-04 14:00:00 +800
tags: [transform, python, Eigen]
---
# 1.坐标转换
## 1.1 旋转矩阵的计算
 note:旋转方向规定是：沿正轴看过去，旋转应当是逆时针
### (1) 二维旋转矩阵的计算
    1 二维旋转的几何定义
        假设在 二维平面 xy 上，有一点P=(x,y)
        该点绕原点逆时针旋转角度θ，得到新的点P'=(x',y')
    2 将P转换为极坐标
        x = r * cosϕ
        y = r * sinϕ
        其中，r = sqrt(x^2 + y^2),ϕ=arctan2(y,x)是点与x轴的夹角
    3 旋转角度θ后，得到的P'用极坐标表示为
        x' = r * cos(ϕ+θ)
        y' = r * sin(ϕ+θ)
	​4 使用三角函数加法公式
        cos(ϕ+θ) = cosϕ * cosθ - sinϕ * sinθ
        sin(ϕ+θ) = sinϕ * cosθ + cosϕ * sinθ
        将上述公式代入P'中可得到
        x' = r * (cosϕ * cosθ - sinϕ * sinθ) = x * cosθ - y * sinθ
        y' = r * (sinϕ * cosθ + cosϕ * sinθ) = y * cosθ + x * sinθ
    至此得到二维旋转矩阵公式：

### (2) 单轴旋转矩阵
    1 绕单轴旋转
        

    

## 1.2 A in B 和 A to B
    A in B = A to B
    若A的坐标系原点在B坐标系的坐标是(a,b,c)
    则T_A_in_B的平移向量就是(a,b,c),旋转向量就是A坐标轴绕某个顺序旋转到B坐标轴的矩阵

# 2. 定轴和动轴
    定轴即在旋转过程中，绕着初始坐标系的轴进行旋转，通过左乘矩阵计算得到
    动轴即在旋转过程中，绕着每一次旋转后更新的坐标系的轴进行旋转，通过右乘矩阵计算得到

# 3. python中的坐标转换
    在python中可以通过scipy.spatial.transform实现
        (1)通过6dof得到变换矩阵
        def xyz_rxryrz2Transformation(xyz_rxryrz, degree = False):  
            """xyz to rxryrz2transformation.

            :param xyz_rxryrz: (1,6) array, contains (x, y, z, roll, pitch, yaw)
            :return
                transformation: a 4x4 RT matrix
            """
            transformation = np.identity(4)
            transformation[:3, :3] = R.from_euler(seq="xyz",
                                                  angles=xyz_rxryrz[3:],
                                                  degrees=degree).as_matrix()
            transformation[0, 3] = xyz_rxryrz[0]
            transformation[1, 3] = xyz_rxryrz[1]
            transformation[2, 3] = xyz_rxryrz[2]
            return transformation
        旋转矩阵的生成方式：
        调用的是 SciPy 的 Rotation.from_euler
        · seq = "xyz":表示旋转顺序
            这是一个内旋（intrinsic rotation,动轴旋转）序列：
            1.先绕当前的x轴旋转roll
            2.再绕新的y轴旋转pitch
            3.最后绕新的z轴旋转yaw
        R 是内旋顺序 x → y → z（动轴），即 roll → pitch → yaw
        · 若seq = "XYZ",是按照固定轴旋转（extrinsic）
        (2)通过变换矩阵得到6dof
        def Transformation2xyz_rxryrz(transformation, degree = False):
            xyz = R.from_matrix(transformation[:3, :3]).as_euler(seq="xyz", degrees=degree)
            return np.concatenate([transformation[:3, 3], xyz])


# 4. Eigen中的坐标转换
# 5. 常用软件中的坐标转换
## 5.1 meshlab
## 5.2 cloudcompare